<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Creating a Skin</title>
  <meta name="description" content="Creating a Skin">

  <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/styles/github.min.css">
  <script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/highlight.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/languages/vbnet.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

  <!-- Overridden theme -->
  <link rel="stylesheet" href="/developer-rhino3d-com-branches/css/main.css">

  <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
  <!-- Optional theme -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap-theme.min.css">
  <!-- Bootstrap override -->
  <link rel="stylesheet" href="/developer-rhino3d-com-branches/css/bootstrap-override.css">

  <link rel="canonical" href="http://mcneel.github.io/developer-rhino3d-com-branches/developer-rhino3d-com-branches/guides/cpp/creating_a_skin/">
  <link rel="alternate" type="application/rss+xml" title="Rhino Developer Docs" href="http://mcneel.github.io/developer-rhino3d-com-branches/developer-rhino3d-com-branches/feed.xml" />

  <link rel="shortcut icon" href="http://developer.rhino3d.com/favicon.ico?v=2" />
  <!-- Saving bookmarks to mobile devices -->
  <!-- For non-Retina (@1× display) iPhone, iPod Touch, and Android 2.1+ devices: -->
  <link rel="apple-touch-icon-precomposed" href="/developer-rhino3d-com-branches/images/apple-touch-icon-precomposed.png"><!-- 57×57px -->
  <!-- For the iPad mini and the first- and second-generation iPad (@1× display) on iOS ≤ 6: -->
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/developer-rhino3d-com-branches/images/apple-touch-icon-72x72-precomposed.png">
  <!-- For the iPad mini and the first- and second-generation iPad (@1× display) on iOS ≥ 7: -->
  <link rel="apple-touch-icon-precomposed" sizes="76x76" href="/developer-rhino3d-com-branches/images/apple-touch-icon-76x76-precomposed.png">
  <!-- For iPhone with @2× display running iOS ≤ 6: -->
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/developer-rhino3d-com-branches/images/apple-touch-icon-114x114-precomposed.png">
  <!-- For iPhone with @2× display running iOS ≥ 7: -->
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="/developer-rhino3d-com-branches/images/apple-touch-icon-120x120-precomposed.png">
  <!-- For iPad with @2× display running iOS ≤ 6: -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/developer-rhino3d-com-branches/images/apple-touch-icon-144x144-precomposed.png">
  <!-- For iPad with @2× display running iOS ≥ 7: -->
  <link rel="apple-touch-icon-precomposed" sizes="152x152" href="/developer-rhino3d-com-branches/images/apple-touch-icon-152x152-precomposed.png">
  <!-- For iPhone 6 Plus with @3× display: -->
  <link rel="apple-touch-icon-precomposed" sizes="180x180" href="/developer-rhino3d-com-branches/images/apple-touch-icon-180x180-precomposed.png">
  <!-- For Chrome for Android: -->
  <link rel="icon" sizes="192x192" href="images/touch-icon-192x192.png">

</head>


  <body>

    <!-- Google Tag Manager **This belongs right after the <body> tag**-->
    <noscript>
        <iframe src="//www.googletagmanager.com/ns.html?id=GTM-MWMDKN"
        height="0" width="0" style="display:none;visibility:hidden"></iframe>
    </noscript>
    <script>
        (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-MWMDKN');
    </script>
    <!-- End Google Tag Manager -->


    <div class="container">
      <header class="site-header">


    <a class="site-title" href="/developer-rhino3d-com-branches/"><img src="/developer-rhino3d-com-branches/images/rhinodevlogo148x128.png" alt="Rhino Developer Docs" height="48" width="56"></a><a class="site-title" href="/developer-rhino3d-com-branches/">Rhino Developer Docs</a>

    <nav class="site-nav">
      <img class="menu-icon" src="/developer-rhino3d-com-branches/images/gi.svg">
      
      <div class="trigger">
      	<!--<a class="page-link" href="/developer-rhino3d-com-branches/">Welcome</a>-->
        
          
            
              
            
          
        
          
            
              
            
          
        
          
            
              
            
          
        
          
            
              
            
          
        
          
            
              
            
          
        
          
            
              
            
          
        
          
            
              
            
          
        
          
        
          
            
              
                <a class="page-link" href="/developer-rhino3d-com-branches/guides/">Guides</a>
              
            
          
        
          
            
              
                <a class="page-link" href="/developer-rhino3d-com-branches/api/">API</a>
              
            
          
        
          
            
              
                <a class="page-link" href="/developer-rhino3d-com-branches/samples/">Samples</a>
              
            
          
        
          
            
          
        
        <a class="page-link" href="http://discourse.mcneel.com/c/rhino-developer">Forums</a>
        <!-- Google Search Engine -->
        <!-- TODO Move to this site back into the Mcneel search, or use a simple site only search for results -->
        <div id="sitesearch">
            <!-- Google CSE Search Box Begins  -->
            <!-- Use of this code assumes agreement with the Google Custom Search Terms of Service. -->
            <!-- The terms of service are available at https://www.google.com/cse/docs/tos.html -->
            <form id="cref" action="/developer-rhino3d-com-branches/search-results.html">
                <input type="hidden" name="cref" value="007988927381198593803:mcq6pshqsn8" />
                <input id="searchtext" type="text" name="q" size="24" value="" placeholder="search" />
                <input class="searchBox" type="submit" name="sa" size="2" value=" " />
            </form>
        <!-- Google CSE Search Box Ends -->
        </div>
        <!--End of Google Search Engine -->
      </div>
    </nav>

</header>


      <div class="page-content">
        

        <!--div class="wrapper"-->
          <div class="container-fluid">

<div class="row-fluid">
    <!--Nav Bar -->
    <nav class="col-xs-0 col-md-3 bs-docs-sidebar">
        <ul id="sidebar" class="nav nav-stacked fixed">

          <li>
            <a href="/developer-rhino3d-com-branches/guides/">Guides</a>

            <ul class="nav nav-stacked">

              <li>

                
                  <a href="/developer-rhino3d-com-branches/guides/#rap">RAP</a>
                
                <ul class="nav nav-stacked">

                  <!-- Find the h1 handle for title -->
                  
                  
                  
                  
                  
                  
                  
                  <li>
                    <a href="#creating-a-skin">Creating a Skin</a>

                    <ul class="nav nav-stacked">

                      <!-- Find the h2 group and any h3 subgroups -->
                      

                      
                        
                        
                        
                        
                        
                        <li>
                          <a href="#overview">Overview</a>

                          

                        </li>
                      
                        
                        
                        
                        
                        
                        <li>
                          <a href="#create-the-skin-dll">Create the Skin DLL</a>

                          

                        </li>
                      
                        
                        
                        
                        
                        
                        <li>
                          <a href="#create-the-skin-plugin">Create the Skin Plugin</a>

                          

                        </li>
                      
                        
                        
                        
                        
                        
                        <li>
                          <a href="#installation">Installation</a>

                          

                        </li>
                      
                        
                        
                        
                        
                        
                        <li>
                          <a href="#additional-info">Additional Info</a>

                          

                        </li>
                      

                    </ul>

                  </li>

                </ul>

              </li>

            </ul>

          </li>

        </ul>
    </nav>
    <!--Main Content -->
    <div class="col-xs-12 col-md-9">
      <!--<div class="post">-->

        <article class="post-content">
          <h1 id="creating-a-skin">Creating a Skin</h1>

<p>This guide outlines the tools for C/C++ developers to wrap their application around Rhino by creating custom Skin.</p>

<h2 id="overview">Overview</h2>

<p>Rhino allows developers to customize most of Rhino’s interface so that the application appears to be their own.  We call this a custom <em>Skin</em>.  With a custom Skin, you can change the application icon, splash screen, the application name etc.</p>

<p>Creating a custom Skin for Rhino involves creating a custom skin assembly:</p>

<ol>
  <li><em>skin name.rhs</em> This is a regular MFC DLL (<em>.dll</em>) that implements the skin’s icon, splash screen, application name, etc.  In this guide, we will refer this to the “Skin DLL.”</li>
  <li><em>skin name.rhp</em> is a Rhino utility plugin that implements the menu handler, if necessary, and one or more custom commands.  In this article, we refer to this as the “Skin Plugin.”</li>
</ol>

<h2 id="create-the-skin-dll">Create the Skin DLL</h2>

<p>To create the Skin DLL:</p>

<ol>
  <li>Launch <em>Visual Studio</em> and run the <em>Rhino Skin DLL wizard</em> installed by the Rhino C/C++ SDK.</li>
  <li>The Rhino Skin DLL wizard creates three classes:</li>
  <li>A <code class="highlighter-rouge">CWinApp</code>-derived class.  This is the entry point of the DLL.</li>
  <li>A <code class="highlighter-rouge">CRhinoSkinDLL</code>-derived class.  This class lets you specify Rhino’s icon, splash screen, and menu.  For more information on this class, see <em>rhinoSdkSkinDLL.h</em>.</li>
  <li><code class="highlighter-rouge">CSplashWnd</code>.  This is a basic implementation of a splash screen class.  If you need something fancier, feel free to replace it with your own implementation.</li>
  <li>Modify the project’s icon and splash screen bitmap.  If your Skin is going to override Rhino’s main menu, then you need to create your menu resources as well.</li>
  <li>Remember to fill out the developer information block found at the top of your <em>DLL’s .cpp</em> file. This block is similar to that of Rhino plugins.</li>
</ol>

<h2 id="create-the-skin-plugin">Create the Skin Plugin</h2>

<p>To create a Skin Plugin:</p>

<ol>
  <li>Launch <em>Visual Studio</em> and run the <em>Rhino Plugin wizard</em> installed by the Rhino C/C++ SDK.  When picking the wizard to run, make sure to add the new project to the open solution instead of creating a new solution.  This way, your Skin project is organized into a single solution.</li>
  <li>If the Skin DLL provides a custom menu, then copy the <em>UUID</em> generated by the plugin <em>AppWizard</em> and found in your plugin’s <code class="highlighter-rouge">CRhinoPlugIn::PlugInID()</code> member to your Skin’s <code class="highlighter-rouge">CRhinoSkinDLL::SkinPlugInID()</code> member.</li>
  <li>These two methods must return the same <em>UUID</em>.  This is a critical step as it identifies the main plugin that Rhino will load to manage its menus and extend the Rhino command set.</li>
  <li>
    <p>Add the following overrides to the header file of your <code class="highlighter-rouge">CRhinoPlugIn</code>-derived class:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code> // Skin DLL menu update handler
 void OnInitPlugInMenuPopups(WPARAM wparam, LPARAM lparam);
 // Skin DLL menu command handler
 BOOL OnPlugInMenuCommand(WPARAM wparam );
 // Change to CRhinoPlugIn::load_plugin_at_startup
 plugin_load_time PlugInLoadTime();
</code></pre>
    </div>
  </li>
  <li>
    <p>Add the following definition to the <em>.cpp</em> file of your <code class="highlighter-rouge">CRhinoPlugIn</code>-derived class:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code> CRhinoPlugIn::plugin_load_time CSkinPlugInSamplePlugIn::PlugInLoadTime()
 {
   // Override to change load time to "at startup"
   return CRhinoPlugIn::load_plugin_at_startup;
 }
</code></pre>
    </div>
  </li>
  <li>If your Skin DLL is providing a custom menu, then add a source file named <em>MenuHandler.cpp</em> to the plugin project and put the definition of <code class="highlighter-rouge">CRhinoPlugIn::OnInitPlugInMenuPopups()</code> and <code class="highlighter-rouge">CRhinoPlugIn::OnPlugInMenuCommand()</code> in this file.</li>
  <li>
    <p>Include the Skin DLL’s <em>Resource.h</em> file in <em>MenuHandler.cpp</em> to provide access to the Skin DLL’s menu resource identifiers.  For example:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code> #include "stdafx.h"
 #include "MySkinPlugIn.h"
 #include "../MySkinDLL/Resource.h"

 // Put these to overrides in a separate CPP file so they could
 // include the MySkinDLL/Resource.h file without conflicting
 // with this projects resource.h

 void CSkinPlugInSamplePlugIn::OnInitPlugInMenuPopups(WPARAM wParam, LPARAM lParam)
 {
   HMENU hMenu = (HMENU)wParam;
   if( NULL == hMenu )
     return;

   switch( GetMenuItemID(hMenu, LOWORD(lParam)) )
   {
     case IDM_SAMPLE_DISABLE:
       ::EnableMenuItem( hMenu, IDM_SAMPLE_DISABLE, MF_BYCOMMAND|MF_DISABLED|MF_GRAYED );
       break;
     case IDM_SAMPLE_SUB_DISABLE:
       ::EnableMenuItem( hMenu, IDM_SAMPLE_SUB_DISABLE, MF_BYCOMMAND|MF_DISABLED|MF_GRAYED );
       break;
     // TODO...
   }
 }

 BOOL CSkinPlugInSamplePlugIn::OnPlugInMenuCommand(WPARAM wParam)
 {
   ON_wString w;
   switch( (UINT)wParam )
   {
     case IDM_SAMPLE_ONE:
       w = L"Test Item One";
       break;
     case IDM_SAMPLE_TWO:
       w = L"Two";
       break;
     case IDM_SAMPLE_DISABLE:
       w = L"Disabled";
       break;
     case IDM_SAMPLE_SUB_A:
       w = L"Sub Menu A";
       break;
     case IDM_SAMPLE_SUB_B:
       w = L"Sub Menu B";
       break;
     case IDM_SAMPLE_SUB_DISABLE:
       w = L"Sub Menu Disabled";
       break;
     default:
       return true;
   }

   ::RhinoMessageBox( w, L"OnMenu", MB_OK );
   return true;
 }
</code></pre>
    </div>
  </li>
  <li>Compile the Skin Plugin.</li>
  <li>Load the Skin Plugin using Rhino’s <em>PluginManager</em> command so it has a chance to self-register.</li>
  <li>Compile the Skin DLL.</li>
</ol>

<h2 id="installation">Installation</h2>

<div class="bs-callout bs-callout-danger">
  <h4>WARNING</h4>
  <p>Modifying the registry incorrectly can have negative consequences on your system's stability and even damage the system.</p>
</div>

<p>To install your custom Skin, use <strong>REGEDIT.EXE</strong> to add a scheme key to your registry with a path to your Skin DLL. For example:</p>

<h4 id="rhino-64-bit">Rhino 64-bit</h4>

<table>
  <thead>
    <tr>
      <th style="text-align: left"><strong>Item</strong></th>
      <th style="text-align: center"> </th>
      <th style="text-align: center"> </th>
      <th style="text-align: left"><strong>Value</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">Subkey</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: left">HKEY_LOCAL_MACHINE\SOFTWARE\McNeel\Rhinoceros\5.0x64\Scheme: MySkin</td>
    </tr>
    <tr>
      <td style="text-align: left">Entry name</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: left">SkinDLLPath</td>
    </tr>
    <tr>
      <td style="text-align: left">Type</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: left">REG_SZ</td>
    </tr>
    <tr>
      <td style="text-align: left">Data value</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: left">C:\Src\MySkin\Bin\Release\MySkin.rhs</td>
    </tr>
  </tbody>
</table>

<h4 id="testing">Testing</h4>

<p>You can now test your custom Skin by creating shortcut to your Rhino executable with <code class="highlighter-rouge">/scheme="&lt;scheme name from the previous step&gt;"</code> as command line argument.  For example:</p>

<p><code class="highlighter-rouge">"C:\Program Files\Rhinoceros 5 (64-bit)\System\Rhino.exe" /scheme=MySkin</code></p>

<h4 id="rhino-32-bit">Rhino 32-bit</h4>

<table>
  <thead>
    <tr>
      <th style="text-align: left"><strong>Item</strong></th>
      <th style="text-align: center"> </th>
      <th style="text-align: center"> </th>
      <th style="text-align: left"><strong>Value</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">Subkey</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: left">HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\McNeel\Rhinoceros\5.0\Scheme: MySkin</td>
    </tr>
    <tr>
      <td style="text-align: left">Entry name</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: left">SkinDLLPath</td>
    </tr>
    <tr>
      <td style="text-align: left">Type</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: left">REG_SZ</td>
    </tr>
    <tr>
      <td style="text-align: left">Data value</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: left">C:\Src\MySkin\Bin\Release\MySkin.rhs</td>
    </tr>
  </tbody>
</table>

<h4 id="testing-1">Testing</h4>

<p>You can now test your custom Skin by creating shortcut to your Rhino executable with <code class="highlighter-rouge">/scheme="&lt;scheme name from the previous step&gt;"</code> as command line argument. For example:</p>

<p><code class="highlighter-rouge">"C:\Program Files (x86)\Rhinoceros 5\System\Rhino4.exe" /scheme=MySkin</code></p>

<h2 id="additional-info">Additional Info</h2>

<p>If the user chooses not to run your skinned version of Rhino, you might want to prevent your Skin plugin loading.  You can do this by checking to see if the name of the scheme that Rhino is using matches your Skin’s scheme name.  Do this by checking in your plugin’s <code class="highlighter-rouge">CRhinoPlugIn::OnLoadPlugIn()</code> member:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">BOOL</span> <span class="n">CSkinPlugInSamplePlugIn</span><span class="o">::</span><span class="n">OnLoadPlugIn</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">ON_wString</span> <span class="n">scheme</span> <span class="o">=</span> <span class="n">RhinoApp</span><span class="p">().</span><span class="n">RegistrySchemeName</span><span class="p">();</span>
  <span class="k">if</span><span class="p">(</span> <span class="n">scheme</span><span class="p">.</span><span class="n">CompareNoCase</span><span class="p">(</span><span class="s">L"Scheme: MySkin"</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">)</span>
    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="c1">// Fail silently...
</span>
  <span class="c1">// TODO...
</span>
  <span class="k">return</span> <span class="n">CRhinoUtilityPlugIn</span><span class="o">::</span><span class="n">OnLoadPlugIn</span><span class="p">();</span>
<span class="p">}</span>
</code></pre>
</div>

        </article>

      <!--</div>-->

    </div>
</div>
</div>

        <!--/div-->
      </div>

      <footer class="site-footer">

  <div class="wrapper">

    <div class="footer-col-wrapper">

      
        <div class="row">
          <div class="col-md-4">
            <p class="text">Author: <a href="mailto:dale@mcneel.com">dale@mcneel.com</a></p>
          </div>
          <div class="col-md-4 text-center">
            <span class="icon  icon--github">
              <svg viewBox="0 0 16 16">
                <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
              </svg>
            </span>
            <a href="https://github.com/mcneel/developer-rhino3d-com-branches/blob/master/_guide_topics/cpp/creating_a_skin.md" target="_blank">Edit page on GitHub</a>
          </div>
            <div class="col-md-4">
              <span class="pull-right">
                <span class="glyphicon glyphicon-cog"></span>&nbsp;<a href="/developer-rhino3d-com-branches/admin">Admin</a>
              </span>
            </div>
        </div>

        <div class="row text-center">
          © 1997 - 2016 Robert McNeel &amp; Associates
        </div>

      

    </div>

  </div>

  <script>
    if (navigator.appVersion.indexOf("Win")!=-1)
    {
      var body = document.getElementsByTagName("body");
      body[0].style.fontWeight = '400';
    }
  </script>

</footer>

    </div>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>

    <!-- MathJax -->
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

    <script type="text/javascript">
    $('body').scrollspy({
        target: '.bs-docs-sidebar',
        offset: 110
    });
    </script>
  </body>

</html>
