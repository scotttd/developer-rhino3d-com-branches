<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Creating your first C/C++ plugin for Rhino</title>
  <meta name="description" content="Your First Plugin (Windows)">

  <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/styles/github.min.css">
  <script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/highlight.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/languages/vbnet.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

  <!-- Overridden theme -->
  <link rel="stylesheet" href="/developer-rhino3d-com-branches/wip/css/main.css">

  <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
  <!-- Optional theme -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap-theme.min.css">
  <!-- Bootstrap override -->
  <link rel="stylesheet" href="/developer-rhino3d-com-branches/wip/css/bootstrap-override.css">

  <link rel="canonical" href="http://mcneel.github.io/developer-rhino3d-com-branches/developer-rhino3d-com-branches/wip/guides/cpp/your_first_plugin_windows/">
  <link rel="alternate" type="application/rss+xml" title="Rhino Developer Docs" href="http://mcneel.github.io/developer-rhino3d-com-branches/developer-rhino3d-com-branches/wip/feed.xml" />

  <link rel="shortcut icon" href="http://developer.rhino3d.com/favicon.ico?v=2" />
  <!-- Saving bookmarks to mobile devices -->
  <!-- For non-Retina (@1× display) iPhone, iPod Touch, and Android 2.1+ devices: -->
  <link rel="apple-touch-icon-precomposed" href="/developer-rhino3d-com-branches/wip/images/apple-touch-icon-precomposed.png"><!-- 57×57px -->
  <!-- For the iPad mini and the first- and second-generation iPad (@1× display) on iOS ≤ 6: -->
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/developer-rhino3d-com-branches/wip/images/apple-touch-icon-72x72-precomposed.png">
  <!-- For the iPad mini and the first- and second-generation iPad (@1× display) on iOS ≥ 7: -->
  <link rel="apple-touch-icon-precomposed" sizes="76x76" href="/developer-rhino3d-com-branches/wip/images/apple-touch-icon-76x76-precomposed.png">
  <!-- For iPhone with @2× display running iOS ≤ 6: -->
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/developer-rhino3d-com-branches/wip/images/apple-touch-icon-114x114-precomposed.png">
  <!-- For iPhone with @2× display running iOS ≥ 7: -->
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="/developer-rhino3d-com-branches/wip/images/apple-touch-icon-120x120-precomposed.png">
  <!-- For iPad with @2× display running iOS ≤ 6: -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/developer-rhino3d-com-branches/wip/images/apple-touch-icon-144x144-precomposed.png">
  <!-- For iPad with @2× display running iOS ≥ 7: -->
  <link rel="apple-touch-icon-precomposed" sizes="152x152" href="/developer-rhino3d-com-branches/wip/images/apple-touch-icon-152x152-precomposed.png">
  <!-- For iPhone 6 Plus with @3× display: -->
  <link rel="apple-touch-icon-precomposed" sizes="180x180" href="/developer-rhino3d-com-branches/wip/images/apple-touch-icon-180x180-precomposed.png">
  <!-- For Chrome for Android: -->
  <link rel="icon" sizes="192x192" href="images/touch-icon-192x192.png">

</head>


  <body>

    <!-- Google Tag Manager **This belongs right after the <body> tag**-->
    <noscript>
        <iframe src="//www.googletagmanager.com/ns.html?id=GTM-MWMDKN"
        height="0" width="0" style="display:none;visibility:hidden"></iframe>
    </noscript>
    <script>
        (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-MWMDKN');
    </script>
    <!-- End Google Tag Manager -->


    <div class="container">
      <header class="site-header">


    <a class="site-title" href="/developer-rhino3d-com-branches/wip/"><img src="/developer-rhino3d-com-branches/wip/images/rhinodevlogo148x128.png" alt="Rhino Developer Docs" height="48" width="56"></a><a class="site-title" href="/developer-rhino3d-com-branches/wip/">Rhino Developer Docs</a>

    <nav class="site-nav">
      <img class="menu-icon" src="/developer-rhino3d-com-branches/wip/images/gi.svg">
      
      <div class="trigger">
      	<!--<a class="page-link" href="/developer-rhino3d-com-branches/wip/">Welcome</a>-->
        
          
            
              
            
          
        
          
            
              
            
          
        
          
            
              
            
          
        
          
            
              
            
          
        
          
            
              
            
          
        
          
            
              
            
          
        
          
            
              
            
          
        
          
        
          
            
              
                <a class="page-link" href="/developer-rhino3d-com-branches/wip/guides/">Guides</a>
              
            
          
        
          
            
              
                <a class="page-link" href="/developer-rhino3d-com-branches/wip/api/">API</a>
              
            
          
        
          
            
              
                <a class="page-link" href="/developer-rhino3d-com-branches/wip/samples/">Samples</a>
              
            
          
        
          
            
          
        
        <a class="page-link" href="http://discourse.mcneel.com/c/rhino-developer">Forums</a>
        <!-- Google Search Engine -->
        <!-- TODO Move to this site back into the Mcneel search, or use a simple site only search for results -->
        <div id="sitesearch">
            <!-- Google CSE Search Box Begins  -->
            <!-- Use of this code assumes agreement with the Google Custom Search Terms of Service. -->
            <!-- The terms of service are available at https://www.google.com/cse/docs/tos.html -->
            <form id="cref" action="/developer-rhino3d-com-branches/wip/search-results.html">
                <input type="hidden" name="cref" value="007988927381198593803:mcq6pshqsn8" />
                <input id="searchtext" type="text" name="q" size="24" value="" placeholder="search" />
                <input class="searchBox" type="submit" name="sa" size="2" value=" " />
            </form>
        <!-- Google CSE Search Box Ends -->
        </div>
        <!--End of Google Search Engine -->
      </div>
    </nav>

</header>


      <div class="page-content">
        
<div class="alert alert-danger" role="alert">
  Hey, you're viewing the <strong>wip</strong> version of the site!
  Click <a href="/developer-rhino3d-com-branches/guides/cpp/your_first_plugin_windows/">here</a> to view the stable version of this page.
</div>


        <!--div class="wrapper"-->
          <div class="container-fluid">

<div class="row-fluid">
    <!--Nav Bar -->
    <nav class="col-xs-0 col-md-3 bs-docs-sidebar">
        <ul id="sidebar" class="nav nav-stacked fixed">

          <li>
            <a href="/developer-rhino3d-com-branches/wip/guides/">Guides</a>

            <ul class="nav nav-stacked">

              <li>

                
                  <a href="/developer-rhino3d-com-branches/wip/guides/#cpp">C/C++</a>
                
                <ul class="nav nav-stacked">

                  <!-- Find the h1 handle for title -->
                  
                  
                  
                  
                  
                  
                  
                  <li>
                    <a href="#your-first-plugin-windows">Your First Plugin (Windows)</a>

                    <ul class="nav nav-stacked">

                      <!-- Find the h2 group and any h3 subgroups -->
                      

                      
                        
                        
                        
                        
                        
                        <li>
                          <a href="#barebones-plugin">Barebones Plugin</a>

                          
                            <ul class="nav nav-stacked">
                              

                              
                                
                                
                                
                                
                                
                                <li>
                                    <a href="#plugin-wizard">Plugin Wizard</a>
                                </li>
                              
                                
                                
                                
                                
                                
                                <li>
                                    <a href="#plugin-anatomy">Plugin Anatomy</a>
                                </li>
                              
                                
                                
                                
                                
                                
                                <li>
                                    <a href="#project-settings">Project Settings</a>
                                </li>
                              
                                
                                
                                
                                
                                
                                <li>
                                    <a href="#boilerplate-build">Boilerplate Build</a>
                                </li>
                              
                                
                                
                                
                                
                                
                                <li>
                                    <a href="#testing">Testing</a>
                                </li>
                              

                            </ul>
                          

                        </li>
                      
                        
                        
                        
                        
                        
                        <li>
                          <a href="#adding-a-command">Adding a Command</a>

                          
                            <ul class="nav nav-stacked">
                              

                              
                                
                                
                                
                                
                                
                                <li>
                                    <a href="#example">Example</a>
                                </li>
                              
                                
                                
                                
                                
                                
                                <li>
                                    <a href="#notes">Notes</a>
                                </li>
                              
                                
                                
                                
                                
                                
                                <li>
                                    <a href="#rhino-command-generator">Rhino Command Generator</a>
                                </li>
                              

                            </ul>
                          

                        </li>
                      
                        
                        
                        
                        
                        
                        <li>
                          <a href="#related-topics">Related Topics</a>

                          

                        </li>
                      

                    </ul>

                  </li>

                </ul>

              </li>

            </ul>

          </li>

        </ul>
    </nav>
    <!--Main Content -->
    <div class="col-xs-12 col-md-9">
      <!--<div class="post">-->

        <article class="post-content">
          <h1 id="your-first-plugin-windows">Your First Plugin (Windows)</h1>

<p>This guide walks you through your first plugin for Rhino for Windows using C/C++ and Visual Studio.</p>

<p>It is presumed you already have the necessary tools installed and are ready to go.  If you are not there yet, see <a href="/developer-rhino3d-com-branches/wip/guides/cpp/installing_tools_windows">Installing Tools (Windows)</a>.</p>

<h2 id="barebones-plugin">Barebones Plugin</h2>

<p>The Rhino SDK includes a Visual Studio Project Wizard.  The wizard program generates the code for a functioning plugin.  Follow these steps to build the plugin…</p>

<h3 id="plugin-wizard">Plugin Wizard</h3>

<ol>
  <li>Launch <em>Visual Studio 2010</em> and navigate to <em>File</em> &gt; <em>New</em> &gt; <em>Project…</em>.</li>
  <li>From the <em>New Project</em> dialog, select the <em>Rhino 5.0 Plug-in</em> template from the list of installed templates…<br />
<img src="/developer-rhino3d-com-branches/wip/images/your_first_plugin_windows_cpp_01.png" alt="New Project Template" /></li>
  <li>Type the project name as shown above.  You can enter a different name if you want.  The wizard uses the project name when it creates files and classes.  If you enter a different name, your files and classes will have a name different from that of the files and classes mentioned in this tutorial.  Don’t forget to choose a location to store the project.  When finished, click the <em>OK</em> button.</li>
  <li>Upon clicking <em>OK</em>, the <em>Overview</em> page of the <em>Rhino 5.0 Plug-In Wizard</em> dialog will appear.  This page gives you an overview of the type of project that the wizard is going to create.  <br />
<img src="/developer-rhino3d-com-branches/wip/images/your_first_plugin_windows_cpp_02.png" alt="New Project Overview" /></li>
  <li>Not that, by default, the wizard will do the following:
    <ol>
      <li>Create a general utility plugin.</li>
      <li>Include source file comments.</li>
      <li>Include support for online help.</li>
    </ol>
  </li>
  <li>If you are satisfied with the default settings, just click the <em>Finish</em> button.  If you want to change any of these settings, click the <em>Next</em> button…<br />
<img src="/developer-rhino3d-com-branches/wip/images/your_first_plugin_windows_cpp_03.png" alt="Plugin Settings" /></li>
  <li>The <em>Plug-in Settings</em> page allows you to modify a number of settings used by the wizard when generating the plugin source code:
    <ol>
      <li><em>Plug-in name</em>: Modify this field if you want to change the name of the plugin.  <em>NOTE</em>: modifying this field does not modify the project name but rather the name of the plugin as listed in Rhino’s <em>PlugInManager</em> dialog box.</li>
      <li><em>Plug-in type</em>: Select the type of plugin that you want the wizard to create.</li>
      <li><em>Source file comments</em>: Select this option if you want the wizard to add verbose comments to the generated source files.</li>
      <li><em>Online help</em>: Select this option if you want your plugin to support online help.  If selected, a menu item will be displayed on Rhino’s <em>Help</em> menu.</li>
      <li><em>Automation</em>: Select this option to allow your program to manipulate objects implemented in another program.  Selecting this option also exposes your program to other Automation client plugins.</li>
      <li><em>Windows sockets</em>: Select this option to indicate that your program supports Windows sockets.  Windows sockets allow you to write programs that communicate over TCP/IP networks.</li>
    </ol>
  </li>
  <li>For this tutorial, just accept the default settings. Click the <em>Finish</em> button, and the wizard begins to generate your plugin project’s folders, files, and classes.  When the wizard is finished, look through the plugin project using <em>Visual Studio’s Solution Explorer</em>…</li>
</ol>

<h3 id="plugin-anatomy">Plugin Anatomy</h3>

<p>The following files are of interest:</p>

<ol>
  <li><em>Test.vcxproj</em> is the project file that allows Visual C++ to build your plugin.</li>
  <li><em>stdafx.h</em> is the main project header.</li>
  <li><em>stdafx.cpp</em> is used to generate precompiled header.</li>
  <li><em>TestApp.h</em> is the application class header that contains the <code class="highlighter-rouge">CTestApp</code> class declaration.</li>
  <li><em>TestApp.cpp</em> is the application class implementation that contains the <code class="highlighter-rouge">CTestApp</code> member functions.</li>
  <li><em>TestPlugIn.h</em> is the plugin class header that contains the <code class="highlighter-rouge">CTestPlugIn</code> class declaration.</li>
  <li><em>TestPlugIn.cpp</em> is the plugin class implementation that contains the <code class="highlighter-rouge">CTestPlugIn</code> member functions.</li>
  <li><em>cmdTest.cpp</em> is the sample <code class="highlighter-rouge">Test</code> Rhino command.</li>
  <li><em>Resource.h</em> is the <code class="highlighter-rouge">#define</code> constant definitions for resources.</li>
  <li><em>Test.rc</em> is the resource script.</li>
  <li><em>Test.def</em> is the module definition.</li>
</ol>

<h3 id="project-settings">Project Settings</h3>

<p>With <em>Visual Studio 2010</em>, a project can target a different version of the Visual C++ libraries and compiler.  This is done by configuring the project use a different <em>Platform</em> toolset…</p>

<p><img src="/developer-rhino3d-com-branches/wip/images/your_first_plugin_windows_cpp_04.png" alt="Test Property Pages" /></p>

<p>Reviewing the above settings, you can see that the Rhino 5 plugin project wizard configures 32-bit builds to use the <em>v80rhinos</em> platform toolset, which equates to using Visual Studio 2005’s libraries and compiler.  This platform toolset configuration is installed on your system by the Rhino C++ SDK Installer.</p>

<p>If you change the active platform from Win32 to x64, you will see that 64-bit builds will use v100, or Visual Studio 2010.</p>

<p>The advantage that platform toolsets provide is that they enable you to take advantage of the IDE enhancements in Visual Studio 2010 while you continue to use an older version of the Visual C++ libraries and compiler.</p>

<h3 id="boilerplate-build">Boilerplate Build</h3>

<p>The <em>Rhino plugin wizard</em>, in addition to generating code, creates a custom project file for your plugin.  This file, <em>Test.vcxproj</em>, specifies all of the file dependencies together with the compile and link option flags.</p>

<p>Before we can build our project, we need to fill in the Rhino plugin developer declarations.  These declarations will let the user of our plugin know who produced the plugin and where they can support information if needed.</p>

<ol>
  <li>
    <p>Open <em>TestPlugIn.cpp</em> and modify the following lines of code, providing your company name and other support information:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code> RHINO_PLUG_IN_DEVELOPER_ORGANIZATION( L"My Company Name" );
 RHINO_PLUG_IN_DEVELOPER_ADDRESS( L"123 Developer Street\r\nCity State 12345-6789" );
 RHINO_PLUG_IN_DEVELOPER_COUNTRY( L"My Country" );
 RHINO_PLUG_IN_DEVELOPER_PHONE( L"123.456.7890" );
 RHINO_PLUG_IN_DEVELOPER_FAX( L"123.456.7891" );
 RHINO_PLUG_IN_DEVELOPER_EMAIL( L"support@mycompany.com" );
 RHINO_PLUG_IN_DEVELOPER_WEBSITE( L"http://www.mycompany.com" );
 RHINO_PLUG_IN_UPDATE_URL( L"http://www.mycompany.com/support" );
</code></pre>
    </div>
  </li>
  <li>
    <p>When finished, delete the following line of source code as the <code class="highlighter-rouge">#error</code> directive will prevent the project from building:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code> #error Developer declarations block is incomplete!
</code></pre>
    </div>
  </li>
  <li>
    <p><em>NOTE</em>: If you do not delete this line, the plugin will build.  You are now ready to build the project by picking <em>Build Test</em> from the <em>Build</em> menu. If the build was successful, a plugin file named <em>Test_d.rhp</em> is created in the project’s <em>Debug</em> folder.</p>
  </li>
</ol>

<h3 id="testing">Testing</h3>

<ol>
  <li>From <em>Visual Studio</em>, navigate to <em>Debug</em> &gt; <em>Start Debugging</em>.  This will load Rhino.  The version of Rhino that is launched depends on the configuration that you build.  The wizard adds the following configurations to your project:
    <ul>
      <li><em>Debug</em>: The Debug configuration of your program is compiled with full symbolic debug information and no optimization.  Optimization complicates debugging, because the relationship between source code and generated instructions is more complex.  The <em>Debug</em> configuration also links with debug runtime libraries.  Plugins built with the <em>Debug</em> configuration will only load in the debug version of Rhino included with the Rhino C/C++ SDK.</li>
      <li><em>PseudoDebug</em>: The <em>PseudoDebug</em> project is a <em>Release</em> project that disables optimizations and generates debugging information using the compiler’s <em>Program Database</em> (<code class="highlighter-rouge">/Zi</code>) option and the linker’s <em>Generate Debug Information</em> (<code class="highlighter-rouge">/DEBUG</code>) option.  These option settings let you use the debugger while you are developing your custom plugin. The <em>PseudoDebug</em> configuration also links with release runtime libraries.  Plugins built with the <em>PseudoDebug</em> configuration will only load in the release version of Rhino that was installed with Rhino.</li>
      <li><em>Release</em>: The <em>Release</em> configuration of your program contains no symbolic debug information and is fully optimized.  <em>Debug</em> information can be generated in PDB Files (C++) depending on the compiler options used.  Creating PDB files can be very useful if you later need to debug your release version.  The <em>Release</em> configuration also links with release runtime libraries.  Plugins built with the <em>Release</em> configuration will only load in the release version of Rhino that was installed with Rhino.</li>
    </ul>
  </li>
  <li>For this guide, build the <em>Debug</em> configuration.</li>
  <li>From within Rhino, navigate to <em>Tools</em> &gt; <em>Options</em>.  Navigate to the <em>Plugins</em> page under <em>Rhino Options</em> and install your plugin.  <em>NOTE</em>: since the debug version of Rhino will only load debug plugins, no other plugins will show up in the list…<br />
<img src="/developer-rhino3d-com-branches/wip/images/your_first_plugin_windows_cpp_05.png" alt="Rhino Options" /></li>
  <li>Once your plugin is loaded, close the options dialog and run your <code class="highlighter-rouge">Test</code> command.  You have finished creating your first plugin!</li>
</ol>

<h2 id="adding-a-command">Adding a Command</h2>

<p>Rhino plugins can contain any number of commands.  Commands are created by deriving a new class from <code class="highlighter-rouge">CRhinoCommand</code>.  See <em>rhinoSdkCommand.h</em> for details on the <code class="highlighter-rouge">CRhinoCommand</code> class.</p>

<h3 id="example">Example</h3>

<p>The following example code demonstrates a simple command class that essentially does nothing:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Do NOT put the definition of class CCommandTest in a header
// file.  There is only ONE instance of a CCommandTest class
// and that instance is the static theTestCommand that appears
// immediately below the class definition.
</span>
<span class="k">class</span> <span class="nc">CCommandTest</span> <span class="o">:</span> <span class="k">public</span> <span class="n">CRhinoCommand</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
  <span class="c1">// The one and only instance of CCommandTest is created below.
</span>  <span class="c1">// No copy constructor or operator= is required.  Values of
</span>  <span class="c1">// member variables persist for the duration of the application.
</span>
  <span class="c1">// CCommandTest::CCommandTest()
</span>  <span class="c1">// is called exactly once when static theTestCommand is created.
</span>  <span class="n">CCommandTest</span><span class="p">()</span> <span class="p">{}</span>

  <span class="c1">// CCommandTest::~CCommandTest()
</span>  <span class="c1">// is called exactly once when static theTestCommand is
</span>  <span class="c1">// destroyed.  The destructor should not make any calls to
</span>  <span class="c1">// the Rhino SDK.  If your command has persistent settings,
</span>  <span class="c1">// then override CRhinoCommand::SaveProfile and CRhinoCommand::LoadProfile.
</span>  <span class="o">~</span><span class="n">CCommandTest</span><span class="p">()</span> <span class="p">{}</span>

  <span class="c1">// Returns a unique UUID for this command.
</span>  <span class="c1">// If you try to use an id that is already being used, then
</span>  <span class="c1">// your command will not work.  Use GUIDGEN.EXE to make unique UUID.
</span>  <span class="n">UUID</span> <span class="n">CommandUUID</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="c1">// {5333C9DE-5F01-45B8-9154-28B765E453E0}
</span>    <span class="k">static</span> <span class="k">const</span> <span class="n">GUID</span> <span class="n">TestCommand_UUID</span> <span class="o">=</span>
    <span class="p">{</span> <span class="mh">0x5333C9DE</span><span class="p">,</span> <span class="mh">0x5F01</span><span class="p">,</span> <span class="mh">0x45B8</span><span class="p">,</span> <span class="p">{</span> <span class="mh">0x91</span><span class="p">,</span> <span class="mh">0x54</span><span class="p">,</span> <span class="mh">0x28</span><span class="p">,</span> <span class="mh">0xB7</span><span class="p">,</span> <span class="mh">0x65</span><span class="p">,</span> <span class="mh">0xE4</span><span class="p">,</span> <span class="mh">0x53</span><span class="p">,</span> <span class="mh">0xE0</span> <span class="p">}</span> <span class="p">};</span>
    <span class="k">return</span> <span class="n">TestCommand_UUID</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// Returns the English command name.
</span>  <span class="k">const</span> <span class="kt">wchar_t</span><span class="o">*</span> <span class="n">EnglishCommandName</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="s">L"Test"</span><span class="p">;</span> <span class="p">}</span>

  <span class="c1">// Returns the localized command name.
</span>  <span class="k">const</span> <span class="kt">wchar_t</span><span class="o">*</span> <span class="n">LocalCommandName</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="s">L"Test"</span><span class="p">;</span> <span class="p">}</span>

  <span class="c1">// Rhino calls RunCommand to run the command.
</span>  <span class="n">CRhinoCommand</span><span class="o">::</span><span class="n">result</span> <span class="n">RunCommand</span><span class="p">(</span> <span class="k">const</span> <span class="n">CRhinoCommandContext</span><span class="o">&amp;</span> <span class="p">);</span>
<span class="p">};</span>

<span class="c1">// The one and only CCommandTest object.  
// Do NOT create any other instance of a CCommandTest class.
</span><span class="k">static</span> <span class="k">class</span> <span class="nc">CCommandTest</span> <span class="n">theTestCommand</span><span class="p">;</span>

<span class="n">CRhinoCommand</span><span class="o">::</span><span class="n">result</span> <span class="n">CCommandTest</span><span class="o">::</span><span class="n">RunCommand</span><span class="p">(</span> <span class="k">const</span> <span class="n">CRhinoCommandContext</span><span class="o">&amp;</span> <span class="n">context</span> <span class="p">)</span>
<span class="p">{</span>
  <span class="c1">// CCommandTest::RunCommand() is called when the user runs the "Test"
</span>  <span class="c1">// command or the "Test" command is run by a history operation.
</span>
  <span class="c1">// TODO: Add command code here.
</span>
  <span class="c1">// Rhino command that display a dialog box interface should also support
</span>  <span class="c1">// a command-line, or scriptable interface.
</span>
  <span class="n">ON_wString</span> <span class="n">wStr</span><span class="p">;</span>
  <span class="n">wStr</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span> <span class="s">L"The </span><span class="se">\"</span><span class="s">%s</span><span class="se">\"</span><span class="s"> command is under construction.</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">EnglishCommandName</span><span class="p">()</span> <span class="p">);</span>
  <span class="k">if</span><span class="p">(</span> <span class="n">context</span><span class="p">.</span><span class="n">IsInteractive</span><span class="p">()</span> <span class="p">)</span>
    <span class="n">RhinoMessageBox</span><span class="p">(</span> <span class="n">wStr</span><span class="p">,</span> <span class="n">PlugIn</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">PlugInName</span><span class="p">(),</span> <span class="n">MB_OK</span> <span class="p">);</span>
  <span class="k">else</span>
    <span class="n">RhinoApp</span><span class="p">().</span><span class="n">Print</span><span class="p">(</span> <span class="n">wStr</span> <span class="p">);</span>

  <span class="c1">// TODO: Return one of the following values:
</span>  <span class="c1">//   CRhinoCommand::success:  The command worked.
</span>  <span class="c1">//   CRhinoCommand::failure:  The command failed because of invalid input, inability
</span>  <span class="c1">//                            to compute the desired result, or some other reason
</span>  <span class="c1">//                            computation reason.
</span>  <span class="c1">//   CRhinoCommand::cancel:   The user interactively canceled the command
</span>  <span class="c1">//                            (by pressing ESCAPE, clicking a CANCEL button, etc.)
</span>  <span class="c1">//                            in a Get operation, dialog, time consuming computation, etc.
</span>  <span class="c1">//   CRhinoCommand::nothing:  The command did nothing but CANCEL was not pressed.
</span>
  <span class="k">return</span> <span class="n">CRhinoCommand</span><span class="o">::</span><span class="n">success</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
</div>

<h3 id="notes">Notes</h3>

<p>A couple things to consider:</p>

<ol>
  <li>Command classes must return a unique UUID.  If you try to use a UUID that is already in use, then your command will not work.  Use the <em>GUIDGEN.EXE</em> that comes with <em>Visual Studio</em> to create unique UUIDs.</li>
  <li>Command classes must return a unique command name.  If you try to use a command name that is already in use, then your command will not work.</li>
  <li>Only ONE instance of a command class can be created.  This is why you should put the definition of your command classes in <em>.cpp</em> files.</li>
</ol>

<h3 id="rhino-command-generator">Rhino Command Generator</h3>

<p>The <em>Rhino Command Generator</em> wizard is a standalone application that will generate new skeleton <code class="highlighter-rouge">CRhinoCommand</code>-derived class.  The generated source code is copied to the Windows clipboard so you can easily paste it into your source files.</p>

<p>To use this tool in Visual Studio 2010:</p>

<ol>
  <li>Launch Visual Studio 2010.</li>
  <li>Navigate to <em>Tools</em> &gt; <em>External Tools…</em>.</li>
  <li>Use the <em>Add</em> button to add the <em>RhinoCommandGenerator.exe</em> file to the list.  The file can be found in the following location: <em>C:\Program Files\Rhino 5.0 x64 SDK\Wizards\Command</em></li>
</ol>

<hr />

<h2 id="related-topics">Related Topics</h2>

<ul>
  <li><a href="/developer-rhino3d-com-branches/wip/guides/general/what_is_a_rhino_plugin">What is a Rhino Plugin?</a></li>
  <li><a href="/developer-rhino3d-com-branches/wip/guides/cpp/installing_tools_windows">Installing Tools (Windows)</a></li>
</ul>

        </article>

      <!--</div>-->

    </div>
</div>
</div>

        <!--/div-->
      </div>

      <footer class="site-footer">

  <div class="wrapper">

    <div class="footer-col-wrapper">

      
        <div class="row">
          <div class="col-md-4">
            <p class="text">Author: <a href="mailto:dale@mcneel.com">dale@mcneel.com</a></p>
          </div>
          <div class="col-md-4 text-center">
            
            
            <span class="icon  icon--github">
              <svg viewBox="0 0 16 16">
                <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
              </svg>
            </span>
            <a href="https://github.com/mcneel/developer-rhino3d-com/blob/gh-pages/_guide_topics/cpp/your_first_plugin_windows.md" target="_blank">Edit page on GitHub</a>
          </div>
            <div class="col-md-4">
              <span class="pull-right">
                <span class="glyphicon glyphicon-cog"></span>&nbsp;<a href="/developer-rhino3d-com-branches/wip/admin">Admin</a>
              </span>
            </div>
        </div>

        <div class="row text-center">
          © 1997 - 2016 Robert McNeel &amp; Associates
        </div>

      

    </div>

  </div>

  <script>
    if (navigator.appVersion.indexOf("Win")!=-1)
    {
      var body = document.getElementsByTagName("body");
      body[0].style.fontWeight = '400';
    }
  </script>

</footer>

    </div>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>

    <!-- MathJax -->
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

    <script type="text/javascript">
    $('body').scrollspy({
        target: '.bs-docs-sidebar',
        offset: 110
    });
    </script>
  </body>

</html>
